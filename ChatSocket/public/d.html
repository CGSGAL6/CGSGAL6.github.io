<!DOCTYPE html>
<html>

<head>
    <title>Socket.IO chat</title>
    <link rel="stylesheet" href="styles.css">
    <script src="/socket.io/socket.io.js"></script>
    <script type="text/javascript">
        let socket = io();

        function sendMessage() {
            let msg = { name: document.getElementById("name").value, message: document.getElementById("message").value };
            if (msg.name == "") msg.name = "anonymus";
            if (msg.message == "") return;
            socket.emit('sendMessage', `${msg.name}:${msg.message}`);
            document.getElementById("message").value = "";
        }
        socket.on('getMessage', msg => {
            let tbl = document.getElementById("msgwnd");
            let result = msg.split(":");
            tbl.insertAdjacentHTML('beforeend', `<tr class="anim"><td class="name">${result[0]}:</td><td class="msg">${result[1]}</td></tr>`);
            tbl.lastChild.scrollIntoView(false);
        });
        function runReact(event) {
            if (event.keyСщву === 13 || event.which == 13) sendMessage();
        }
        function recoveryRequest() {
            socket.emit('requesRrecovery', 'code:30');
        }
        socket.on('receiveRecovery', recDATA => {
            let tbl = document.getElementById("msgwnd");
            if (recDATA == "") return;
            tbl.insertAdjacentHTML('beforeend', recDATA);
            tbl.lastChild.scrollIntoView(false);
        });
    </script>
</head>

<body onload="recoveryRequest();">
    <div class="cont">
        <p id="header">Chat</p>
        <input placeholder="name" type="text" id="name" /><br>
        <input placeholder="enter message" type="text" id="message" onkeypress="runReact(event)" /><br>
        <!-- //<button onclick="sendMessage();" id="send_msg_bttn">Send Message</button> -->
        <div style="overflow-y: scroll; height: 70vh; width: 50vw;" id="messages_scrool">
            <p id="messages_pane"></p>
        </div>
    </div>
</body>

</html>